graph LR
subgraph Ingress_Normalization
A[Kajabi Webhook] --> B[Validate API Key - Dynamic] --> C[Smart Field Mapper]
end
C --> D{Feature Gate: PERSON_WATERFALL_ENABLED}
subgraph Person_Enrichment
PDL[PDL Person Enrichment] --> PPROC[PDL Person Processor]
PPROC --> S{PDL Success Check}
end
D --> PDL
S -->|true| M[(Data Merge: PDL > Hunter)]
S -->|false| HHTTP[Hunter.io People Find]
HHTTP --> HPROC[Hunter Response Processor]
HPROC --> M
M --> ICP[OpenAI ICP Scoring V3]
M -.-> HR[Add to Human Review Queue]
ICP --> ICPP[ICP Response Processor]
ICPP --> ROUTE{Score-Based Routing V3.0}
ROUTE -->|Low Score| AL[Archive Low Scores] --> AA[Archive to Airtable]
ROUTE -->|Continue| LUF[Log Unknown Fields] --> CUK[Check Unknown Fields] --> AS[Airtable Search - Dynamic] --> DH[Duplicate Handler - Dynamic] --> RBD{Route by Duplicate]
RBD -->|Duplicate| UPS[Airtable Upsert - Dynamic]
RBD -->|New Record| CRT[Airtable Create - Dynamic]